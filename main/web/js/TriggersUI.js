var S=class{constructor(t){this.triggersList=null;this.editFormContainer=null;this.addTriggerBtn=null;this.app=t,this.initializeUIElements(),this.initializeEventListeners()}initializeUIElements(){this.triggersList=document.getElementById("triggers-list"),this.editFormContainer=document.getElementById("trigger-edit-form-container"),this.addTriggerBtn=document.getElementById("add-trigger")}initializeEventListeners(){this.addTriggerBtn&&this.addTriggerBtn.addEventListener("click",()=>{this.showEditForm(null,-1)})}loadTriggers(){!this.triggersList||!this.app.settings.Triggers||(this.triggersList.innerHTML="",this.editFormContainer&&(this.editFormContainer.innerHTML="",this.editFormContainer.classList.remove("active")),this.app.settings.Triggers.forEach((t,C)=>{if(this.triggersList===null)return;let s=document.createElement("tr");s.dataset.index=C.toString();let c=document.createElement("td");c.textContent=t.match,s.appendChild(c);let E=document.createElement("td");E.textContent=t.type||"regex",s.appendChild(E);let a=document.createElement("td");a.textContent=t.actionType||"text",s.appendChild(a);let l=document.createElement("td");l.textContent=t.actions,s.appendChild(l);let d=document.createElement("td"),r=document.createElement("button");r.textContent="Edit",r.style.marginRight="5px",r.addEventListener("click",()=>{this.showEditForm(t,C)});let v=document.createElement("button");v.textContent="Delete",v.addEventListener("click",()=>{this.app.settings.Triggers.splice(C,1),this.app.saveSettings(),this.loadTriggers()}),d.appendChild(r),d.appendChild(v),s.appendChild(d),this.triggersList.appendChild(s)}))}showEditForm(t,C){if(!this.editFormContainer)return;this.editFormContainer.innerHTML="";let s=document.createElement("h4");s.textContent=C===-1?"Add New Trigger":"Edit Trigger",this.editFormContainer.appendChild(s);let c=document.createElement("div");c.className="form-row";let E=document.createElement("label");E.textContent="Pattern:",E.setAttribute("for","edit-trigger-pattern");let a=document.createElement("input");a.type="text",a.id="edit-trigger-pattern",a.value=t?t.match:"",a.placeholder="e.g., ^You are hungry\\.$",c.appendChild(E),c.appendChild(a),this.editFormContainer.appendChild(c);let l=document.createElement("div");l.className="form-row";let d=document.createElement("label");d.textContent="Match Type:",d.setAttribute("for","edit-trigger-type");let r=document.createElement("select");r.id="edit-trigger-type",["regex","substring","exact"].forEach(e=>{let n=document.createElement("option");n.value=e,n.textContent=e.charAt(0).toUpperCase()+e.slice(1),(t&&t.type===e||!t&&e==="regex")&&(n.selected=!0),r.appendChild(n)}),l.appendChild(d),l.appendChild(r),this.editFormContainer.appendChild(l);let T=document.createElement("div");T.className="form-row";let b=document.createElement("label");b.textContent="Action Type:",b.setAttribute("for","edit-trigger-action-type");let p=document.createElement("select");p.id="edit-trigger-action-type",["text","javascript"].forEach(e=>{let n=document.createElement("option");n.value=e,n.textContent=e.charAt(0).toUpperCase()+e.slice(1),(t&&t.actionType===e||!t&&e==="text")&&(n.selected=!0),p.appendChild(n)}),T.appendChild(b),T.appendChild(p),this.editFormContainer.appendChild(T);let x=document.createElement("div");x.className="form-row";let w=document.createElement("label");w.textContent="Actions:",w.setAttribute("for","edit-trigger-actions");let o=document.createElement("textarea");o.id="edit-trigger-actions",o.value=t?t.actions:"",o.placeholder="Enter commands or JavaScript code",p.addEventListener("change",()=>{p.value==="text"?o.placeholder="Enter commands to execute when triggered":o.placeholder="Enter JavaScript code to execute when triggered"}),x.appendChild(w),x.appendChild(o),this.editFormContainer.appendChild(x);let y=document.createElement("div");y.innerHTML="<small>Tip: Triggers automatically execute actions when matching text appears in the MUD output.<br>Text actions are sent to the MUD as commands.<br>JavaScript actions are executed in the browser and can use <code>window.mudApp</code> to interact with the client.</small>",y.style.marginTop="5px",y.style.color="#999",this.editFormContainer.appendChild(y);let m=document.createElement("div");m.className="pattern-test-container";let N=document.createElement("h4");N.textContent="Test Pattern",m.appendChild(N);let f=document.createElement("div");f.className="form-row";let F=document.createElement("label");F.textContent="Test Text:",F.setAttribute("for","pattern-test-input");let u=document.createElement("textarea");u.id="pattern-test-input",u.placeholder="Enter text to test against the pattern",u.rows=4,u.style.width="calc(100% - 110px)",u.style.maxWidth="400px",f.appendChild(F),f.appendChild(u),m.appendChild(f);let A=document.createElement("button");A.textContent="Test Pattern",A.addEventListener("click",()=>{let e=a.value,n=r.value,M=u.value;if(!e||!M)return;let I=!1;try{I=this.app.matchTrigger(M,n,e);let i=document.getElementById("pattern-test-result");i||(i=document.createElement("div"),i.id="pattern-test-result",i.className="pattern-test-result",m.appendChild(i)),I?(i.textContent="Match found! The trigger would activate.",i.className="pattern-test-result success"):(i.textContent="No match. The trigger would not activate.",i.className="pattern-test-result failure")}catch(i){let h=document.getElementById("pattern-test-result");h||(h=document.createElement("div"),h.id="pattern-test-result",h.className="pattern-test-result",m.appendChild(h)),h.textContent=`Error: ${i instanceof Error?i.message:"Unknown error"}`,h.className="pattern-test-result failure"}}),m.appendChild(A),this.editFormContainer.appendChild(m);let g=document.createElement("div");g.className="button-row",g.style.marginTop="20px";let B=document.createElement("button");B.textContent="Save",B.addEventListener("click",()=>{C===-1?this.app.settings.Triggers.push({match:a.value,type:r.value,actions:o.value,actionType:p.value}):t&&(t.match=a.value,t.type=r.value,t.actions=o.value,t.actionType=p.value),this.app.saveSettings(),this.loadTriggers()});let L=document.createElement("button");L.textContent="Cancel",L.style.backgroundColor="#555",L.addEventListener("click",()=>{this.editFormContainer&&(this.editFormContainer.innerHTML="",this.editFormContainer.classList.remove("active"))}),g.appendChild(B),g.appendChild(L),this.editFormContainer.appendChild(g),this.editFormContainer.classList.add("active"),t&&t.actionType==="javascript"&&(o.placeholder="Enter JavaScript code to execute when triggered")}updateUI(){this.loadTriggers()}};export{S as TriggersUI};
//# sourceMappingURL=TriggersUI.js.map
